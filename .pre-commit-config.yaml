repos:
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.8.4
    hooks:
      # Run the linter
      - id: ruff
        args: [--fix]
      # Run the formatter
      - id: ruff-format

  # ty type checker (using system hook until official hook available)
  - repo: local
    hooks:
      - id: ty
        name: ty type checker
        entry: uvx ty check
        language: system
        types: [python]
        pass_filenames: false
        # Ignore rules that have many false positives with Protocol types and dynamic patterns
        args: [
          --ignore, unresolved-import,
          --ignore, invalid-argument-type,    # Protocol conformance issues
          --ignore, call-non-callable,        # Dynamic callable patterns
          --ignore, unresolved-attribute,     # Dynamic attribute access
          --ignore, possibly-missing-attribute,  # Optional attribute access
          --ignore, no-matching-overload,     # Dict method overloads
          --ignore, unsupported-operator,     # Operator overloading issues
          --ignore, invalid-return-type,      # Complex return type inference
          --ignore, invalid-assignment,       # Dynamic attribute assignment
          --ignore, invalid-type-form,        # Complex type expressions
          --ignore, not-iterable,             # Dynamic iterables
          --ignore, invalid-method-override,  # Protocol method signatures
          --ignore, unknown-argument,         # Dynamic kwargs / evolving APIs
          .]
